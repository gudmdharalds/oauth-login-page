# oauth-login-page

Login-page written in PHP, suitable for authentication via OAuth 2.0 server. Standalone, no frameworks.

# Features
- Communicates with OAuth 2.0 servers for authentication
- Supports being invoked to authenticate user from another site, will redirect back to it after authentication.
- Grabs tokens from OAuth 2.0 server and gives to the authenticated user's browser
- Only recognized sites will be able to have users authenticate and redirected back.
- Uses sophisticated nonce strings to counteract attempts to steal authentication tokens.
- Uses sessions to generate nonce strings, and to do security checks - sessions are stored in a DB.

# Security features
- OAuth 2.0
- Redirect URIs are checked against a list of known URIs
- Nonce tokens are used to counteract attempts to let users use other forms to submit against oauth-login-page
- Nonce tokens are created, using a static secret key (configurable), a session secret (attached to user's session, autogenerated), a salt and an expiry timestamp. These are then hashed. The nonce string will contain the salt, timestamp and the resulting hash.

# TODO
- Implement simple rate-limiting functionality

# Installing 

## Configuration file

## Configure PHP

It is recommended to use database connection pooling, as the code does a lot of fast-run queries, and each request takes a short while.

## Creating DB-table

```sql
CREATE TABLE `lp_sessions` (
  `session_id` varchar(256) CHARACTER SET latin1 NOT NULL DEFAULT '',
  `session_expires` int(10) unsigned NOT NULL DEFAULT '0',
  `session_data` text,
  PRIMARY KEY (`session_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8
```

